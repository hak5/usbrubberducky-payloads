REM_BLOCK
############################################################
#                                                          #
# Title        : Defend yourself against AtlasVPN Bug-Door #
# Author       : Aleff                                     #
# Version      : 1.0                                       #
# Category     : Execution                                 #
# Target       : Linux                                     #
#                                                          #
############################################################
END_REM

REM Requirements:
REM     - Administrator Permission
REM     - AtlasVPN installed

REM Define the sudo user password
DEFINE #SUDO-PWS example

EXTENSION DETECT_READY
    REM VERSION 1.1
    REM AUTHOR: Korben

    REM_BLOCK DOCUMENTATION
        USAGE:
            Extension runs inline (here)
            Place at beginning of payload (besides ATTACKMODE) to act as dynamic
            boot delay

        TARGETS:
            Any system that reflects CAPSLOCK will detect minimum required delay
            Any system that does not reflect CAPSLOCK will hit the max delay of 3000ms
    END_REM

    REM CONFIGURATION:
    DEFINE #RESPONSE_DELAY 25
    DEFINE #ITERATION_LIMIT 120

    VAR $C = 0
    WHILE (($_CAPSLOCK_ON == FALSE) && ($C < #ITERATION_LIMIT))
        CAPSLOCK
        DELAY #RESPONSE_DELAY
        $C = ($C + 1)
    END_WHILE
    CAPSLOCK
END_EXTENSION

CTRL-ALT t
DELAY 2000

REM Add the rule and close the shell
STRINGLN sudo iptables -A INPUT -p tcp --dport 8076 -m state --state NEW -j DROP; exit;

REM Add the rule and display it
REM STRINGLN sudo iptables -A INPUT -p tcp --dport 8076 -m state --state NEW -j DROP; sudo iptables -S | grep "8076";

REM Remove the rule
REM STRINGLN sudo iptables -D INPUT -p tcp --dport 8076 -m state --state NEW -j DROP

DELAY 500
STRINGLN #SUDO-PWS
