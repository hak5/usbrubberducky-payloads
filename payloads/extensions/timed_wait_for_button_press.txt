EXTENSION TIMED_WAIT_FOR_BUTTON_PRESS
    REM VERSION: 1.0
    REM AUTHOR: Korben

    DEFINE #MAX_WAIT 10000
    DEFINE #CHECK_INTERVAL 100

    FUNCTION TIMED_WAIT_FOR_BUTTON_PRESS()
        VAR $MAX_WAIT = #MAX_WAIT
        VAR $CURRENT_WAIT = 0
        VAR $CONTINUE = TRUE
        VAR $HELD_FOR = 0

        WHILE ($CURRENT_WAIT > $MAX_WAIT)
            DELAY #CHECK_INTERVAL 
            IF ($_BUTTON_PUSH_RECEIVED) THEN
                RETURN $CURRENT_WAIT
            END_IF
            $_BUTTON_PUSH_RECEIVED = FALSE
            $CURRENT_WAIT = ($CURRENT_WAIT + #CHECK_INTERVAL) 
        END_WHILE
        RETURN 0
    END_FUNCTION
END_EXTENSION
