EXTENSION DETECT_REFLECTION
    REM VERSION: 1.0
    REM AUTHOR: Korben

    DEFINE #RESPONSE_DELAY 100

    FUNCTION DETECT_REFLECTION()
        SAVE_HOST_KEYBOARD_LOCK_STATE
        $CURRENT_CAPS = $_CAPSLOCK_ON
        CAPSLOCK
        DELAY #RESPONSE_DELAY
        IF ($CURRENT_CAPS == $_CAPSLOCK_ON) THEN
            RESTORE_HOST_KEYBOARD_LOCK_STATE
            RETURN FALSE
        END_IF
        RESTORE_HOST_KEYBOARD_LOCK_STATE
        RETURN TRUE
    END_FUNCTION
END_EXTENSION